{"remainingRequest":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\src\\components\\Tinymce\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\src\\components\\Tinymce\\index.vue","mtime":1556098057077},{"path":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pancheng\\Desktop\\pancheng\\毕业设计\\project\\houzhidao\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport editorImage from \"./components/editorImage\";\nimport plugins from \"./plugins\";\nimport toolbar from \"./toolbar\";\nexport default {\n  name: \"Tinymce\",\n  components: {\n    editorImage: editorImage\n  },\n  props: {\n    id: {\n      type: String,\n      default: function _default() {\n        return \"vue-tinymce-\" + +new Date() + ((Math.random() * 1000).toFixed(0) + \"\");\n      }\n    },\n    value: {\n      type: String,\n      default: \"\"\n    },\n    toolbar: {\n      type: Array,\n      required: false,\n      default: function _default() {\n        return [];\n      }\n    },\n    menubar: {\n      type: String,\n      default: \"file edit insert view format table\"\n    },\n    height: {\n      type: Number,\n      required: false,\n      default: 360\n    }\n  },\n  data: function data() {\n    return {\n      hasChange: false,\n      hasInit: false,\n      tinymceId: this.id,\n      fullscreen: false,\n      languageTypeList: {\n        en: \"en\",\n        zh: \"zh_CN\"\n      }\n    };\n  },\n  computed: {\n    language: function language() {\n      return this.languageTypeList[\"zh\"];\n    }\n  },\n  watch: {\n    value: function value(val) {\n      var _this2 = this;\n\n      if (!this.hasChange && this.hasInit) {\n        this.$nextTick(function () {\n          return window.tinymce.get(_this2.tinymceId).setContent(val || \"\");\n        });\n      }\n    },\n    language: function language() {\n      var _this3 = this;\n\n      this.destroyTinymce();\n      this.$nextTick(function () {\n        return _this3.initTinymce();\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.initTinymce();\n  },\n  activated: function activated() {\n    this.initTinymce();\n  },\n  deactivated: function deactivated() {\n    this.destroyTinymce();\n  },\n  destroyed: function destroyed() {\n    this.destroyTinymce();\n  },\n  methods: {\n    initTinymce: function initTinymce() {\n      var _this4 = this;\n\n      var _this = this;\n\n      window.tinymce.init({\n        language: this.language,\n        selector: \"#\".concat(this.tinymceId),\n        height: this.height,\n        body_class: \"panel-body \",\n        object_resizing: false,\n        toolbar: this.toolbar.length > 0 ? this.toolbar : toolbar,\n        menubar: this.menubar,\n        plugins: plugins,\n        end_container_on_empty_block: true,\n        powerpaste_word_import: \"clean\",\n        code_dialog_height: 450,\n        code_dialog_width: 1000,\n        advlist_bullet_styles: \"square\",\n        advlist_number_styles: \"default\",\n        imagetools_cors_hosts: [\"www.tinymce.com\", \"codepen.io\"],\n        default_link_target: \"_blank\",\n        link_title: false,\n        nonbreaking_force_tab: true,\n        // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n        init_instance_callback: function init_instance_callback(editor) {\n          if (_this.value) {\n            editor.setContent(_this.value);\n          }\n\n          _this.hasInit = true;\n          editor.on(\"NodeChange Change KeyUp SetContent\", function () {\n            _this4.hasChange = true;\n\n            _this4.$emit(\"input\", editor.getContent());\n          });\n        },\n        setup: function setup(editor) {\n          editor.on(\"FullscreenStateChanged\", function (e) {\n            _this.fullscreen = e.state;\n          });\n        } // 整合七牛上传\n        // images_dataimg_filter(img) {\n        //   setTimeout(() => {\n        //     const $image = $(img);\n        //     $image.removeAttr('width');\n        //     $image.removeAttr('height');\n        //     if ($image[0].height && $image[0].width) {\n        //       $image.attr('data-wscntype', 'image');\n        //       $image.attr('data-wscnh', $image[0].height);\n        //       $image.attr('data-wscnw', $image[0].width);\n        //       $image.addClass('wscnph');\n        //     }\n        //   }, 0);\n        //   return img\n        // },\n        // images_upload_handler(blobInfo, success, failure, progress) {\n        //   progress(0);\n        //   const token = _this.$store.getters.token;\n        //   getToken(token).then(response => {\n        //     const url = response.data.qiniu_url;\n        //     const formData = new FormData();\n        //     formData.append('token', response.data.qiniu_token);\n        //     formData.append('key', response.data.qiniu_key);\n        //     formData.append('file', blobInfo.blob(), url);\n        //     upload(formData).then(() => {\n        //       success(url);\n        //       progress(100);\n        //     })\n        //   }).catch(err => {\n        //     failure('出现未知问题，刷新页面，或者联系程序员')\n        //     console.log(err);\n        //   });\n        // },\n\n      });\n    },\n    destroyTinymce: function destroyTinymce() {\n      var tinymce = window.tinymce.get(this.tinymceId);\n\n      if (this.fullscreen) {\n        tinymce.execCommand(\"mceFullScreen\");\n      }\n\n      if (tinymce) {\n        tinymce.destroy();\n      }\n    },\n    setContent: function setContent(value) {\n      window.tinymce.get(this.tinymceId).setContent(value);\n    },\n    getContent: function getContent() {\n      window.tinymce.get(this.tinymceId).getContent();\n    },\n    imageSuccessCBK: function imageSuccessCBK(arr) {\n      var _this = this;\n\n      arr.forEach(function (v) {\n        window.tinymce.get(_this.tinymceId).insertContent(\"<img class=\\\"wscnph\\\" src=\\\"\".concat(v.url, \"\\\" >\"));\n      });\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div :class=\"{fullscreen:fullscreen}\" class=\"tinymce-container editor-container\">\r\n        <textarea :id=\"tinymceId\" class=\"tinymce-textarea\"/>\r\n        <div class=\"editor-custom-btn-container\">\r\n            <editorImage color=\"#1890ff\" class=\"editor-upload-btn\" @successCBK=\"imageSuccessCBK\"/>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport editorImage from \"./components/editorImage\";\r\nimport plugins from \"./plugins\";\r\nimport toolbar from \"./toolbar\";\r\n\r\nexport default {\r\n    name: \"Tinymce\",\r\n    components: { editorImage },\r\n    props: {\r\n        id: {\r\n            type: String,\r\n            default: function() {\r\n                return (\r\n                    \"vue-tinymce-\" +\r\n                    +new Date() +\r\n                    ((Math.random() * 1000).toFixed(0) + \"\")\r\n                );\r\n            }\r\n        },\r\n        value: {\r\n            type: String,\r\n            default: \"\"\r\n        },\r\n        toolbar: {\r\n            type: Array,\r\n            required: false,\r\n            default() {\r\n                return [];\r\n            }\r\n        },\r\n        menubar: {\r\n            type: String,\r\n            default: \"file edit insert view format table\"\r\n        },\r\n        height: {\r\n            type: Number,\r\n            required: false,\r\n            default: 360\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            hasChange: false,\r\n            hasInit: false,\r\n            tinymceId: this.id,\r\n            fullscreen: false,\r\n            languageTypeList: {\r\n                en: \"en\",\r\n                zh: \"zh_CN\"\r\n            }\r\n        };\r\n    },\r\n    computed: {\r\n        language() {\r\n            return this.languageTypeList[\"zh\"];\r\n        }\r\n    },\r\n    watch: {\r\n        value(val) {\r\n            if (!this.hasChange && this.hasInit) {\r\n                this.$nextTick(() =>\r\n                    window.tinymce.get(this.tinymceId).setContent(val || \"\")\r\n                );\r\n            }\r\n        },\r\n        language() {\r\n            this.destroyTinymce();\r\n            this.$nextTick(() => this.initTinymce());\r\n        }\r\n    },\r\n    mounted() {\r\n        this.initTinymce();\r\n    },\r\n    activated() {\r\n        this.initTinymce();\r\n    },\r\n    deactivated() {\r\n        this.destroyTinymce();\r\n    },\r\n    destroyed() {\r\n        this.destroyTinymce();\r\n    },\r\n    methods: {\r\n        initTinymce() {\r\n            const _this = this;\r\n            window.tinymce.init({\r\n                language: this.language,\r\n                selector: `#${this.tinymceId}`,\r\n                height: this.height,\r\n                body_class: \"panel-body \",\r\n                object_resizing: false,\r\n                toolbar: this.toolbar.length > 0 ? this.toolbar : toolbar,\r\n                menubar: this.menubar,\r\n                plugins: plugins,\r\n                end_container_on_empty_block: true,\r\n                powerpaste_word_import: \"clean\",\r\n                code_dialog_height: 450,\r\n                code_dialog_width: 1000,\r\n                advlist_bullet_styles: \"square\",\r\n                advlist_number_styles: \"default\",\r\n                imagetools_cors_hosts: [\"www.tinymce.com\", \"codepen.io\"],\r\n                default_link_target: \"_blank\",\r\n                link_title: false,\r\n                nonbreaking_force_tab: true, // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\r\n                init_instance_callback: editor => {\r\n                    if (_this.value) {\r\n                        editor.setContent(_this.value);\r\n                    }\r\n                    _this.hasInit = true;\r\n                    editor.on(\"NodeChange Change KeyUp SetContent\", () => {\r\n                        this.hasChange = true;\r\n                        this.$emit(\"input\", editor.getContent());\r\n                    });\r\n                },\r\n                setup(editor) {\r\n                    editor.on(\"FullscreenStateChanged\", e => {\r\n                        _this.fullscreen = e.state;\r\n                    });\r\n                }\r\n                // 整合七牛上传\r\n                // images_dataimg_filter(img) {\r\n                //   setTimeout(() => {\r\n                //     const $image = $(img);\r\n                //     $image.removeAttr('width');\r\n                //     $image.removeAttr('height');\r\n                //     if ($image[0].height && $image[0].width) {\r\n                //       $image.attr('data-wscntype', 'image');\r\n                //       $image.attr('data-wscnh', $image[0].height);\r\n                //       $image.attr('data-wscnw', $image[0].width);\r\n                //       $image.addClass('wscnph');\r\n                //     }\r\n                //   }, 0);\r\n                //   return img\r\n                // },\r\n                // images_upload_handler(blobInfo, success, failure, progress) {\r\n                //   progress(0);\r\n                //   const token = _this.$store.getters.token;\r\n                //   getToken(token).then(response => {\r\n                //     const url = response.data.qiniu_url;\r\n                //     const formData = new FormData();\r\n                //     formData.append('token', response.data.qiniu_token);\r\n                //     formData.append('key', response.data.qiniu_key);\r\n                //     formData.append('file', blobInfo.blob(), url);\r\n                //     upload(formData).then(() => {\r\n                //       success(url);\r\n                //       progress(100);\r\n                //     })\r\n                //   }).catch(err => {\r\n                //     failure('出现未知问题，刷新页面，或者联系程序员')\r\n                //     console.log(err);\r\n                //   });\r\n                // },\r\n            });\r\n        },\r\n        destroyTinymce() {\r\n            const tinymce = window.tinymce.get(this.tinymceId);\r\n            if (this.fullscreen) {\r\n                tinymce.execCommand(\"mceFullScreen\");\r\n            }\r\n\r\n            if (tinymce) {\r\n                tinymce.destroy();\r\n            }\r\n        },\r\n        setContent(value) {\r\n            window.tinymce.get(this.tinymceId).setContent(value);\r\n        },\r\n        getContent() {\r\n            window.tinymce.get(this.tinymceId).getContent();\r\n        },\r\n        imageSuccessCBK(arr) {\r\n            const _this = this;\r\n            arr.forEach(v => {\r\n                window.tinymce\r\n                    .get(_this.tinymceId)\r\n                    .insertContent(`<img class=\"wscnph\" src=\"${v.url}\" >`);\r\n            });\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.tinymce-container {\r\n    position: relative;\r\n    line-height: normal;\r\n}\r\n.tinymce-container >>> .mce-fullscreen {\r\n    z-index: 10000;\r\n}\r\n.tinymce-textarea {\r\n    visibility: hidden;\r\n    z-index: -1;\r\n}\r\n.editor-custom-btn-container {\r\n    position: absolute;\r\n    right: 4px;\r\n    top: 4px;\r\n    /*z-index: 2005;*/\r\n}\r\n.fullscreen .editor-custom-btn-container {\r\n    z-index: 10000;\r\n    position: fixed;\r\n}\r\n.editor-upload-btn {\r\n    display: inline-block;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/Tinymce"}]}